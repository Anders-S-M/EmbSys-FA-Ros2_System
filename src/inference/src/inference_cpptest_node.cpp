#include "rclcpp/rclcpp.hpp"
#include "sensor_msgs/msg/image.hpp"
#include "std_msgs/msg/int32.hpp"
#include "cv_bridge/cv_bridge.h"
#include "opencv2/opencv.hpp"
#include <chrono>

class ImageInferenceNode : public rclcpp::Node {
public:
    ImageInferenceNode() : Node("inference_cpptest_node") {

        // Starting our integer publisher and image subscriber
        subscriber_ = create_subscription<sensor_msgs::msg::Image>(
            "image_classify", 1, std::bind(&ImageInferenceNode::imageCallback, this, std::placeholders::_1));
        publisher_ = create_publisher<std_msgs::msg::Int32>("class_id", 1);
    }


    float max(float a, float b, float c, float d)
    {
        if (a > b && a > c && a > d)
            return a;

        else if (b > c && b > d)
            return b;

        else if (c > d)
            return c;

        return d;
    }

    void maxPooling(float arr[], int w, int h, float out[]) {
        int t = 0;

        for (int i = 0; i < h - 1; i += 2) {
            for (int j = 0; j < w - 1; j += 2) {
                // Check if the next pooling window goes beyond the width or height
                int width_limit;
                int height_limit;

                if (j + 1 < w - 1)
                    width_limit = j + 1;
                else
                    width_limit = w - 1;

                if (i + 1 < h - 1)
                    height_limit = i + 1;
                else
                    height_limit = h - 1;

                out[t++] = max(
                    arr[i * w + j], arr[(i + 1) * w + j],
                    arr[i * w + width_limit], arr[height_limit * w + width_limit]
                );
            }
        }
    }

    void convOperation(float arr[], float filter[], int w, int h, float out[], float bias) {
        int t = 0;
        float sum;

        // Apply pipeline pragma to the outer loop for better throughput
        for (int i = 1; i < h - 1; i++) {

            for (int j = 1; j < w - 1; j++) {
                sum = bias;

                for (int m = 0; m < 3; m++) {

                    for (int n = 0; n < 3; n++) {
                        sum += arr[(i - 1 + m) * w + (j - 1 + n)] * filter[m * 3 + n];
                    }
                }

                out[t++] = sum;
            }
        }
    }

    void fullyConnected(float in[], int size_in, const float weights[], int size_w, float out[], float bias[])
    {

        float sum;
        for (int i = 0; i < size_w; i++)
        {
            sum = 0;
            for (int j = 0; j < size_in; j++)
            {
                sum += weights[(size_w * j) + i] * in[j];
            }
            out[i] = sum + bias[i];
        }
        return;
    }

    void relu(float in[], float out[], int size) 
    {
        for (int i = 0; i < size; i++) 
        {
            out[i] = (in[i] >= 0) ? in[i] : 0;
        }
    }

    void softmax(float scores[], int size) 
    {
        float max_score = scores[0];
        for (int i = 1; i < size; ++i) 
        {
            if (scores[i] > max_score) 
            {
                max_score = scores[i];
            }
        }

        float sum = 0.0;
        for (int i = 0; i < size; ++i) 
        {
            scores[i] = exp(scores[i] - max_score);
            sum += scores[i];
        }

        for (int i = 0; i < size; ++i) 
        {
            scores[i] /= sum;
        }
    }

    int inference(int in[1200])
    {
        // --------------------------------- Initializing CNN ----------------------------------------------
        const int height0 = 30;
        const int width0 = 40;
        const int height0_conv = height0 - 2;
        const int width0_conv = width0 - 2;
        const int height1 = height0_conv / 2;
        const int width1 = width0_conv / 2;
        const int height1_conv = height1 - 2;
        const int width1_conv = width1 - 2;
        const int height2 = height1_conv / 2;
        const int width2 = width1_conv / 2;
        const int height2_conv = height2 - 2;
        const int width2_conv = width2 - 2;
        const int height_last = height2_conv / 2;
        const int width_last = width2_conv / 2;

        float conv_out[height0 * width0] = {};
        float pool_out[height0 * width0] = {};

        // --------------------------------- Convolutional Layers ------------------------------------------
        for (int i = 0; i < height0 * width0; i++)
        {
            pool_out[i] = in[i] / 255.0;
        }


        convOperation(pool_out, layer_0, width0, height0, conv_out, bias_conv_0);
        relu(conv_out, conv_out, width0 * height0);
        maxPooling(conv_out, width0_conv, height0_conv, pool_out);

        convOperation(pool_out, layer_1, width1, height1, conv_out, bias_conv_1);
        relu(conv_out, conv_out, width1 * height1);
        maxPooling(conv_out, width1_conv, height1_conv, pool_out);

        convOperation(pool_out, layer_2, width2, height2, conv_out, bias_conv_2);
        relu(conv_out, conv_out, width2 * height2);
        maxPooling(conv_out, width2_conv, height2_conv, pool_out);


        // --------------------------------- Fully-Connected Layer -----------------------------------------
        int weights_0_size = 64;
        int weights_1_size = 32;
        int weights_2_size = 12;
        int weights_3_size = 4;

        fullyConnected(pool_out, width_last * height_last, weights_0, weights_0_size, conv_out, bias_layer0);
        relu(conv_out, conv_out, weights_0_size);

        fullyConnected(conv_out, weights_0_size, weights_1, weights_1_size, pool_out, bias_layer1);
        relu(pool_out, pool_out, weights_1_size);

        fullyConnected(pool_out, weights_1_size, weights_2, weights_2_size, conv_out, bias_layer2);
        relu(conv_out, conv_out, weights_2_size);

        fullyConnected(conv_out, weights_2_size, weights_3, weights_3_size, pool_out, bias_layer3);

        // --------------------------- Soft-max the results and output this --------------------------------
        softmax(pool_out, weights_3_size);

        for(int i = 0; i < weights_3_size; i++){
            if (round(pool_out[i]) == 1){
                return i;
            }
        }

        return 0;
    }


    void imageCallback(const sensor_msgs::msg::Image::SharedPtr msg) {
        // Convert the ROS image message to an OpenCV image
        cv_bridge::CvImagePtr cv_ptr;
        try {
            cv_ptr = cv_bridge::toCvCopy(msg, sensor_msgs::image_encodings::MONO8);
        } catch (cv_bridge::Exception& e) {
            RCLCPP_ERROR(get_logger(), "cv_bridge exception: %s", e.what());
            return;
        }
        
        image_raw = cv_ptr->image;
        // Process the image (e.g., perform some OpenCV operations)
        // cv::cvtColor(cv_ptr->image, image_raw, cv::COLOR_BGR2GRAY);
        cv::resize(image_raw, image_raw, cv::Size(40,30));

        // Create an array to hold the pixel values
        int pixelArray[1200]; // 40x30 = 1200

        // Copy the pixel values from the image to the array
        for (int i = 0; i < 30; i++) {
            for (int j = 0; j < 40; j++) {
                pixelArray[i * 40 + j] = image_raw.at<char>(i, j);
            }
        }

        int output = 4;
        auto start_time = std::chrono::high_resolution_clock::now();

        output = inference(pixelArray);

        auto end_time = std::chrono::high_resolution_clock::now();
        auto duration = std::chrono::duration_cast<std::chrono::microseconds>(end_time - start_time);

        // And then publish the class id
        auto message = std_msgs::msg::Int32();
        message.data = output;    //Enable

        publisher_->publish(message);

        RCLCPP_INFO(this->get_logger(), "Seen image and classified as class: %i \n", message.data);
        RCLCPP_INFO(get_logger(), "Time taken by the inference code: %ld microseconds\n", duration);
    }

private:
    rclcpp::Subscription<sensor_msgs::msg::Image>::SharedPtr subscriber_;
    rclcpp::Publisher<std_msgs::msg::Int32>::SharedPtr publisher_;
    sensor_msgs::msg::Image::SharedPtr msg_;
    cv::Mat image_raw;
    // ------------------------------------------------------------ Filter Weights -------------------------------------------------------------------
    float layer_0[9] = { -1.4501821, -0.07353041, 1.2461681, -0.9844161, 0.33982557, 1.6350787, -3.214681, 0.06439075, 0.056473166 };
    float bias_conv_0 = 0.6283289;

    float layer_1[9] = { 0.16173346, -1.6669217, 0.014579554, -1.3708557, -0.9124009, 1.4603875, -1.3534732, 0.37606546, 1.7937545 };
    float bias_conv_1 = -0.0024055715;

    float layer_2[9] = { -0.054053888, 0.30297995, 1.4806021, 0.014593791, 0.607756, 0.6971556, 0.256939, 0.40213138, 0.49381167 };
    float bias_conv_2 = 0.00050419674;

    // -------------------------------------------------------- Fully-Connected Weights -------------------------------------------------------------------
    float weights_0[384] = { 0.31524387, -0.053517632, -0.21919438, -0.15688337, 0.66148776, 0.40395936, -0.26244396, -0.36299098, -0.2791538, -0.19265766, 0.30045193, -0.506771, 0.46510145, 0.07054108, 0.21468405, -0.05007242, 0.020908814, -0.39117047, -0.17567259, 0.7275241, 0.8414948, 0.073682345, -0.067088634, 0.0038649482, 0.0679543, -0.8422057, -0.9742473, 0.3047584, 0.14149854, -1.004836, 0.18376899, -1.7879843, -0.27222973, -0.11144853, -0.41013834, -0.2559585, 0.42733526, 0.062966734, -0.04837159, -1.702279, 0.19896294, -0.30187395, 0.075903766, -0.47720236, -0.21389914, -1.3133395, -2.2164311, 0.00053804147, 0.41289943, 0.021468343, 1.0639017, 0.28479737, -0.7942764, 0.63853437, 0.19214116, -0.7719944, -0.84661305, -0.6657333, -0.20312229, -1.0660673, -0.13860594, -0.38736433, -0.031832874, -1.2817916, 2.0730762, 0.21569678, -0.10983378, -1.6366488, 1.2124529, 2.0116017, -4.0288534, 1.0133692, -0.10261941, -0.48173007, 1.8726418, -1.714199, -1.2681756, 2.5789692, 0.818799, -0.28669238, -2.8102334, -0.082157895, -0.18010436, 1.3220986, 0.23095843, 2.9653633, 0.042168777, 0.16646473, -4.986848, -1.8103378, 2.5500846, -2.197451, 1.0090145, -1.1082882, 0.904109, 1.0544701, 0.08536121, -2.0332143, -0.040340144, 0.11367477, 1.945751, -5.4525213, 0.97650456, 3.0983193, -1.828085, 1.2329824, 0.8175834, 0.24329406, -0.024005264, 2.5349176, 0.54987854, 0.54568905, -5.622278, -0.72767025, 0.8118874, 1.104357, -2.5005069, 1.0653836, 0.28303754, 0.6439413, 0.47324818, -0.37113708, 0.121989384, 0.3423546, -4.020062, 0.93070686, 0.6322131, 1.8347572, 1.6912436, -8.974678, -0.044648036, -9.05152, -11.458556, 2.35594, 6.162602, 1.3046372, -0.08009702, -0.15953995, -1.6166786, 7.5940576, 2.2781887, 4.5961566, 7.130395, -0.3064353, 7.9283247, 3.9423003, -0.8003157, 1.1504248, 0.24115661, 4.7102375, -11.551098, -3.48042, 4.6862574, -2.1227272, 0.07827235, -0.15584795, -5.9264827, 0.9340917, -2.7575355, 2.9997525, 1.4872543, -0.13363318, 7.2451463, 2.1680408, 4.729035, 5.462988, -11.568084, -7.6374683, 2.7286608, -0.079321146, 1.168758, 2.0945473, -0.026672602, 1.2226264, -0.861005, 0.9218692, 9.885828, 8.263207, 1.3659524, -3.8589878, 2.282778, -1.892724, -39.054466, 0.4539409, 2.1402342, 0.39622805, -0.15511413, 5.045285, -1.6317258, -5.3066816, -3.0710487, 2.1993303, -0.979449, -0.5373979, -0.07575466, -0.14169997, -1.1828834, -0.054151297, 0.648145, 0.197704, -0.24044079, -0.1415151, -1.0220649, 0.708442, 0.3715702, 0.27394938, 0.16162889, -0.0060111657, -0.6864269, -0.0068872916, 0.6259889, -1.445402, -1.1556009, -1.1583493, 0.20460296, -0.2657398, 0.7924953, -0.7218019, 0.658867, -0.88628334, -0.03536698, 1.0861616, -0.40562195, -4.878571, 0.25127304, -0.19593172, 0.33190745, -0.06666323, -0.5495541, -0.04681976, 0.17253645, 0.36459917, -0.09285159, -0.07857584, -0.22090799, 1.0014377, -0.12926005, 0.29608828, 0.22316097, -0.4905074, -0.839218, -0.028220555, -4.227961, -0.5476001, 0.62918186, 0.07088597, -0.044877887, -0.09850929, 1.1022047, 0.87426424, 0.29965925, 0.0095985085, 0.42086595, 0.56581867, -1.2094425, 0.5777386, 0.75880456, 0.7921863, -0.02672398, 0.81605214, -3.286286, 0.44705912, 0.96414185, -1.6558411, -0.20749322, -0.4022352, -1.0638868, -1.296595, 0.21296905, -0.09670657, -1.1312383, 0.009361524, 1.0971314, 1.073559, -0.65117085, 0.3870334, -0.95856696, -0.65190196, 1.7414943, 2.037761, -1.9543473, 1.1648902, 0.47150722, 2.490809, -0.58881575, 0.13874327, 1.2069603, 1.3768085, -0.1450715, -0.1528331, -0.08633515, -0.5685542, -2.2265933, -0.02123587, 2.1428287, -0.89613944, -14.100287, -2.2827759, 2.199368, 0.61059767, -0.281679, -1.3656827, 2.0197861, 0.26897997, -1.2100194, 0.4681418, 0.06473108, 1.0911728, 0.39853093, -0.35437742, -0.5943891, -0.26302236, 0.36451173, 0.06662511, 1.5577202, 1.6464095, 1.5768915, -7.0324297, 1.54911, 1.231817, 1.8499302, -3.263587, -0.2037686, 3.5023565, 4.446404, 0.16943617, -2.9328089, 1.9299321, 0.098743945, 0.21915424, -1.6091232, -3.1932487, -4.2660475, -2.1500273, -0.5885712, -0.24338351, -0.5616229, 1.278639, 4.915875, -0.019810798, 3.692033, -1.184258, -10.913272, 2.6225939, -1.0592673, 5.5787816, 2.0914774, -4.881578, -36.127087, 0.8954747, -0.49220866, 0.6668297, -0.6348697, 1.0258791, -7.7544284, 0.14432852, -8.099578, 3.1348903, -1.5367466, 0.26693097, -0.12586969, 4.5321755, -5.777241, -0.6880054, -0.2837418, 2.2174466, 4.0707765, 0.57274294, -3.861568, -1.8305869, -5.1343884, 3.0574691, 2.7416956, 0.31036445, 3.36326, 1.6717149, -1.9269077, -0.3929829, 2.1944165, -2.2220852, 0.16855085, 1.454003, 0.4444247, 4.295935 };
    float bias_layer0[64] = { -1.9462051, 1.9854954, 0.0, 1.4845885, -3.301166, -6.0157003, -0.17244692, -0.9895191, 0.0, -9.503489e-05, 1.2216728, 1.3653011, -1.785991, -1.2339861, -2.7277756, -0.06262483, 0.62383837, 1.2090099, -0.549364, -0.95321286, -0.5681006, -0.14419837, 0.47220924, -1.4668766, 0.08008342, 1.5264748, -0.49128497, 0.13636495, 0.26197803, 0.53123933, -0.14780527, 1.8822747, 1.2490892, 1.7264154, 0.65124226, 2.4018052, 0.3627015, -0.04756576, -1.7365034, 0.52292526, 0.7582194, 1.7356752, -0.25446743, 0.10119291, 0.0, 1.6960578, -0.2331219, 1.1426823, 1.08492, -0.041092876, -0.1289987, -0.306152, 1.1545303, -4.7111626, -0.04541413, 2.5611277, -0.07464998, 0.5814465, -3.165537, 0.9891589, 0.40899706, 1.0265985, 1.3856459, -3.1762674 };

    float weights_1[2048] = { 0.8447616, -0.8656136, -1.0561016, -0.7382758, -1.7625353, 0.6840575, -0.042627968, -0.07089961, -0.69226927, -0.023790687, -0.18671604, 0.60974175, 0.40544295, -0.55151767, -0.19332309, -1.1244107, -1.3249664, -1.2568814, 0.34002542, -3.3186219, 1.5051639, -0.61370516, 0.6110663, -2.2277243, 1.6043077, 2.1048205, 0.5853931, -2.3173382, -0.33011097, -0.121540464, -3.168728, -0.680279, -1.136869, 1.1290404, -0.5292815, 0.17373559, -0.623418, -0.4522397, 0.40596655, -0.92831284, -1.3406632, 0.1606475, 0.80611265, -0.6400216, -0.777327, -0.22902659, -2.9433203, 0.5117162, 0.03559854, -0.83196723, 0.055472326, 1.1639487, -1.5982335, -0.09611249, 0.37515235, 0.89804715, 1.7824743, -1.1081797, 0.5829597, -0.20544697, 2.6911836, 0.051938538, -0.46374038, 2.1205142, -0.07992917, -0.121498644, -0.19592118, 0.06584966, 0.16336304, 0.15437293, 0.18296194, 0.22243035, -0.17128915, -0.055731297, 0.026689053, -0.01231873, 0.08618194, 0.21234351, 0.07716215, -0.10489088, -0.04187119, -0.09212792, -0.078169405, -0.090048075, 0.23320395, -0.050772846, 0.20856768, 0.23051822, 0.2057274, -0.1960718, -0.24375528, 0.031228125, 0.17584878, 0.032452166, 0.106107235, 0.19206864, -0.053408585, -0.39025083, -1.5133821, -0.9379157, 0.20293951, 1.2430012, 0.47940427, 1.765964, -1.1956416, -0.16354895, 1.1876048, 0.17170003, 1.6185132, -1.2507645, 2.4109871, -2.7556503, 0.010474677, 1.447836, 0.7493103, 0.32612407, 0.07382805, -1.1063755, -1.5203247, 1.7581748, -0.61321133, -0.3515547, 0.37545732, 0.66249055, -0.2885534, -0.16884907, -1.4224974, 0.10360337, 0.16512308, -2.3971682, -0.4014561, 1.5364522, -4.514599, 2.6263723, -2.2628062, 0.021510143, -1.3023791, -0.06382012, 2.1767597, 2.3007836, 1.0625465, -4.0192084, -2.8893673, 5.016124, -2.6790469, -4.245972, -1.9843013, -2.2336566, -4.4364004, -1.3730134, 1.6822481, -2.532831, -2.114889, -0.9656244, -3.8051646, 0.07758597, -0.65446997, -1.2735672, -0.06360302, -0.26013684, 0.5970583, 1.4019729, 0.35581544, -0.1487071, 2.403653, 2.9501698, 0.5106019, -0.34126776, 1.1997311, -0.27177048, -2.232416, 0.12393548, -5.5145087, 0.096227795, -0.5158037, -4.410397, 4.334187, -0.19609843, -1.3200983, -3.065617, -5.0638685, -1.3203523, 0.9417797, 1.7663121, -1.3662968, -0.7861197, 2.2538743, 2.7690384, -2.9899323, -4.2680874, -3.8477883, 0.83243215, 0.95433927, -3.4611347, 0.021541147, 0.9046394, 1.561755, 0.091838, 1.0434335, 1.425474, -0.32037827, -0.032018747, 2.4468246, -3.4394596, 1.3350347, 1.5263246, 0.17052041, -2.054657, -0.9399932, -0.48544028, 1.139128, -0.90782, -0.24299105, -2.3799016, -0.97953063, 0.10610533, -0.33756953, 0.19799794, -0.60550624, -0.8405948, -0.15639487, 0.19019215, -0.27373087, -0.5653887, 3.3727362, -2.7894256, 3.1284869, -1.9153467, 2.0691237, 2.4186828, -2.0814428, -0.37025997, 3.7882433, 0.1490557, 3.256595, -0.7447329, -6.598149, 1.4781761, 1.4045825, 5.735134, 2.5736756, 1.5034989, -0.61223954, 3.943596, -0.2501738, 0.24987538, 4.6896644, 1.7188269, 0.18904601, -0.115214676, -3.6672018, 3.0331175, 0.585253, 1.9468359, -2.3399575, -1.2792228, -0.11669713, -0.13905889, 0.09132874, -0.12242007, -0.24518156, 0.01960516, -0.13905543, 0.121943355, 0.20444208, -0.2053271, 0.045758903, -0.12499809, -0.08223897, -0.004691124, -0.22324109, 0.04122436, -0.2208597, 0.026388764, 0.0103343725, -0.11298281, 0.1110698, -0.23687166, 0.099443614, -0.11189461, -0.23609436, 0.10302776, 0.13953942, 0.22044557, 0.2037732, 0.20249766, 0.22057062, -0.15706712, 0.582648, 0.038196445, 0.13604724, -0.047359794, 0.02666294, 0.016349897, 0.1204179, 0.018585943, 0.027534246, -0.09283954, -0.14617598, -0.09020092, -0.25189555, -0.12731689, 0.11644254, -0.06359713, 0.13681473, 0.18452448, 0.41051984, -0.10409862, 0.11821377, -0.11153939, 0.052899957, 0.24308214, -0.18359706, 0.22808847, 0.030430106, 0.12893154, -0.29328474, 0.14196344, -0.005135071, 0.16147442, -1.5976378, -0.13061436, 0.7180526, 2.133174, -0.17891768, -1.1055244, 0.72877485, 0.21458942, -0.75589836, -0.22913606, -0.9421708, -0.84563273, -0.80167186, -0.6422372, -0.90123206, -2.1743996, 0.7140215, -0.36517552, 0.59497947, 1.4559478, -12.692765, 0.91592354, 1.0448921, 1.785391, 1.5169617, 0.26872084, 0.16041215, -1.0521266, -0.09273004, 1.3166368, 0.38926652, -1.4023067, 0.17353345, -5.6899056, 3.6753716, 2.4240267, 0.98821014, 0.8281155, -0.87522453, -0.109839104, -2.830267, -0.01711119, -2.530157, -0.44268233, -0.55533975, -1.654157, 0.6402141, 0.7318457, -2.2913337, -1.5056938, -2.0461168, -0.70163226, 0.8875885, -1.6224786, 0.8301373, 0.28024364, -0.4689392, -0.4755904, -0.057673536, -0.97710836, 0.27252033, 0.5218479, 1.6756473, 2.579071, 0.90585786, -0.23042601, -0.42208406, 0.034045953, -1.9360571, -0.70383686, -1.127968, -0.47069004, 0.46472344, -0.05075472, -0.55121374, -0.3354673, -4.082504, 0.3766671, -1.5736624, -0.14439677, -3.0799997, -0.55959094, 0.39341068, 2.2097385, -0.4521983, -2.6635685, -0.41184363, -0.52198845, -0.69831365, 1.1131052, 0.65969914, -0.6346849, -1.2828048, 0.5900224, 0.66974247, 1.0435551, 1.2201968, 0.013295523, 1.0119696, -1.4316308, 1.7725505, 0.45069423, 0.25773126, 1.1507163, 0.7444613, -0.03080785, -0.4494695, 0.16424377, 1.178542, 0.7907748, -0.35321283, -2.0249734, -0.8086449, 1.4660852, 1.2128781, -3.983626, -1.6678045, -0.06365429, 0.8351155, -0.40754855, 0.4577082, 0.039134048, -0.48206744, -1.7105998, 0.91361654, 0.5496349, 0.9101514, -0.076603875, -4.2898746, -1.0795609, 1.0120484, 0.37346062, 0.14190264, 2.3240151, 0.1715937, -0.05508046, 2.289816, 0.08349194, 0.053774904, 0.7002734, 0.5359546, 0.0019881646, 1.4386108, -2.5941675, -3.2490506, -0.51544726, -1.8707945, 1.9894928, -9.508559, -1.5894545, -3.4630547, -1.5549355, -4.1302996, -0.08019984, -1.7198856, -0.64612573, -0.5927988, -1.4148917, -2.0905085, 1.049613, 0.23664029, 0.067704, -0.17546037, -0.26379573, -0.055923402, -0.22304213, -0.16027756, -0.1786517, 0.22350204, -0.087302566, -0.26614398, 0.024649557, 0.14671901, 0.07926827, 0.021840168, -0.030107824, 0.16313784, 0.089685135, -0.18859239, 0.0060285428, -0.032119334, 0.10500431, 0.09687859, 0.04642089, -0.070658006, -0.21226822, 0.028892007, -0.2861017, -0.14100365, -0.1679428, -0.10004892, 0.33247322, 4.5801244, -0.56745857, -0.8768564, 1.1962845, 0.9123217, 0.5513101, -0.2865461, 2.5601895, -1.0742459, 0.11198574, -0.14094274, 0.13313569, -2.1368763, -1.0521641, 1.1281409, 1.5783924, 0.3098772, 0.6482172, 0.4131162, 0.11159424, -7.7908096, -0.05616041, 3.2805355, -0.43847412, -0.48709658, -1.7227632, 1.6667997, -1.900508, 0.41457364, -1.0784508, 0.3217152, 0.15315504, -0.42781758, -0.7189661, 0.7586107, 1.6252564, -0.7303389, 0.022292359, -0.24001212, -1.3051991, 1.3245413, -0.07562573, -0.44309443, 2.0936315, -0.15743831, 0.3577766, -0.24241029, 1.8219533, 0.0015904551, 1.2842236, 0.5822923, -0.23824209, -0.36039406, 1.7116029, 0.88371766, 0.7032004, 0.34918594, -0.12305719, 0.06820351, 0.09711922, 0.9512805, 1.7986584, 1.286569, 0.8995708, 0.69607025, 0.9011875, 0.2085215, -0.9478653, -1.3183959, -1.5536116, 0.7648277, 1.0101569, -1.9659783, -0.24889268, 0.03749079, -2.827621, -2.0955243, -0.05434327, -0.76444787, 0.033179305, -6.4831862, -0.24065405, -0.0009128672, -0.454193, 0.50959957, 0.49698547, -1.0596005, 0.70493287, 0.3777998, -0.5171386, 0.43085903, 1.4797208, 0.8860378, 0.12813216, 0.15545677, -0.5768173, 1.3476528, 1.3280087, 1.7220241, -0.8386045, 0.8923615, 0.70647246, 0.58686733, -0.27817065, -0.39017573, -0.26269314, -2.1209357, 0.27586102, 5.1426096, 1.3029132, 1.1816106, 0.9784013, -2.0172298, -0.05039514, 1.1877356, 2.5622447, -4.722487, 0.6921237, 0.15980901, 0.0005907564, 0.28800002, 1.8477682, 0.64688283, -1.1901371, -1.0874463, 0.2213242, -0.20102502, 0.36450058, 1.5048112, 0.61483234, 0.118292965, 0.4854394, 1.1943083, -2.0306394, -0.32789305, -0.9765217, 0.9057736, -0.2581955, -0.7834454, 0.5122351, -0.98834604, 1.7083342, 1.4399351, -2.0722747, -1.0282469, 1.277488, -0.7433587, -2.7088213, 0.3875711, 0.5401288, -1.7225851, 0.53222066, -0.39689627, -0.1332499, 0.7430381, 0.30672935, -0.48910904, -0.7215038, -0.046804223, 1.3373111, -4.184042, 2.9084287, -1.2690607, -1.3295566, 0.48266247, -1.7878938, -0.9881729, 1.7087394, 1.1458931, 0.06665116, 3.1011977, -1.0839498, -0.17644244, -3.8028073, 0.77650446, -0.4788048, 3.2002678, -0.61725426, -0.40727273, 1.5833833, -0.4875649, 0.430372, -2.3811412, 1.5805545, -0.215446, -0.8917063, -0.50332916, 1.4159437, 1.7914859, -0.10335198, -0.08734878, -0.46375048, -2.078054, -1.5585405, -0.54382885, -0.8289193, -3.7460415, 0.29589462, -2.054807, -1.1030941, 1.3057176, -0.19416502, 1.01518, 1.2183279, -0.18171926, -1.292043, 0.558127, -0.40038514, 0.49475622, -0.23439328, -2.8740897, -3.2774267, -2.8750765, 0.90642965, 0.57166034, 0.12883455, -0.41722912, 1.2758206, 0.093288325, -0.080722034, 0.92458063, -0.8085432, -0.70376325, 0.3556123, -0.36589792, 0.6779082, 0.5041054, 0.012255677, -0.25497803, 0.9366263, -0.348725, -2.2633288, -0.5651356, 0.10536636, 0.28711832, -2.710446, -0.7560301, 0.3090973, 0.59097797, 1.3498911, -3.6329489, 0.12933424, 0.056310065, -0.46228886, -2.205975, -1.14691, -0.5816128, 0.45377666, -1.5282024, -0.22851844, -0.18027946, 0.63834685, 0.5444137, 0.057257876, -1.990524, 0.29789197, -1.9741495, 0.9584316, 0.0823346, 0.2751167, -1.3146414, -1.514309, -0.38075292, -0.12077616, -1.1211315, -0.08283081, -0.5981252, -1.4632732, -0.56462705, -1.0998096, -0.037502296, 1.0512931, 0.016963191, 0.33021328, -0.14174093, -0.3496753, 1.1431255, 0.9034564, 0.9373718, 0.25958055, 0.3468919, -1.4281632, 0.80929387, 0.46228728, -1.3038621, -2.0648856, 1.2416335, 1.7669928, -0.9625798, 1.4118502, -0.029080499, -0.45841, -2.305201, 2.8083115, -2.0222383, -1.3886137, -1.2893636, -0.09062407, 0.9026503, 0.11416195, 2.725269, 1.4808849, -1.3945442, -0.34730202, 1.4762865, -2.9616988, 0.20226398, -0.16117963, -3.9223773, -1.9059557, -1.6296027, -1.1144778, 0.039620887, 2.499148, -0.24052389, 1.8952585, -0.2849179, -0.08147746, -0.43402335, -1.9757538, -1.7039524, -0.07858368, -1.170387, -0.120647475, 0.3644317, -1.5789641, 0.5777429, 0.6987811, -0.8846922, -0.30852923, 0.6412373, -0.6653295, 0.69563633, -1.6757514, 0.17187889, 0.91158557, 1.7422073, 0.9485625, -0.015473409, 2.007891, 0.43925944, -0.15566388, -0.24063921, 0.8843831, 0.23053378, -1.8379707, -1.2860658, -0.08471419, -0.3495073, 1.5500171, -0.42712006, 0.044025425, 0.25677577, 0.42441574, 0.7349309, 1.3653442, -3.8441901, -0.6862984, -0.21927442, 1.4667101, 0.21494132, -0.063882835, 0.52136475, 2.2474675, -6.3703303, -0.26355743, -1.2376477, 0.47785333, -0.7623943, -3.4842415, 0.32994014, 3.5571907, 1.8968885, 0.9652776, 0.85763055, -0.3456004, -2.3420784, 0.8752399, -0.15513332, 1.2213435, 0.41289294, -0.30695313, -2.2145333, 0.64012414, -0.10788671, -1.3271849, 1.3022299, -1.144195, -1.0332525, -1.9040066, -0.0040180357, -0.7959906, -0.60218126, -0.18816082, -0.4680823, -2.3093324, 1.1534009, 0.20964214, 0.7796074, -0.5984736, 0.48502824, -0.16773775, 2.0012074, -1.3103398, -0.009582048, -0.8984989, 1.197121, 0.37800843, 0.16166863, -0.8581335, -2.1432388, -0.2625017, 3.7129524, 1.2984668, 0.2789467, -2.6631086, -0.25447345, -0.5226793, -3.3983762, 0.92089397, -0.39045978, -1.5299073, -2.6478636, -0.9029263, 0.58566165, -0.001839048, -0.8334753, 1.3046197, 0.6312067, -0.13033627, 0.0040798793, -0.0063446434, 0.65925753, -1.0848656, -2.4659946, 1.4313663, -0.30149773, -0.24908563, -1.8437582, 0.18432215, -0.26527587, -1.2424686, -5.0403357, 0.25972572, 0.58161485, -0.3596595, -1.1740559, 0.8341172, 0.7237409, -0.24659534, 0.94896764, -0.5902112, 0.08083678, -0.21264456, 0.5228214, -1.5888138, 0.8477246, -0.28608435, 0.18484968, 0.16605788, 2.118904, 0.7984162, 0.7306555, 1.7537796, -0.10584499, -0.060346954, -0.08076875, -0.25602007, 0.17040247, 0.8171541, 0.48897886, 0.9278019, 0.596579, -0.04196938, 0.7924681, -0.3441009, -0.7086704, 0.25280035, -0.20679167, -0.8653848, -2.0803587, 5.446532, -1.667591, 0.55957925, 2.2892234, -1.1194733, 0.71437854, -1.8825564, -0.9826413, -0.0037438031, -0.75211436, -0.34408638, -0.24750808, 0.23349379, -1.2225771, 1.4978551, -1.0703365, -3.5031583, -1.7278626, 2.288835, 0.15247104, -1.0595042, -4.9242992, 2.4166958, 1.2389469, 1.3318188, 1.694818, 0.2935705, -1.6127591, 0.8344935, 3.1403613, 4.0992985, 0.4743914, -1.464361, -0.13942012, -0.777003, 0.51545054, -0.13449956, 0.7662409, 0.8585133, 1.1090935, -0.10828056, 0.54033345, 1.9070796, -0.14961794, 0.47206444, 0.5065521, 0.52178437, 0.61649495, 0.96511453, 0.8659709, -0.1926326, 0.32113868, 2.017217, 0.693144, 0.4736556, 0.34440097, 0.88539964, 0.047713604, 0.004935212, -0.16038373, 0.6312519, 0.5056422, 0.3852078, 0.6110749, 1.1723666, -0.12810244, -0.71902823, 0.83964473, -0.6014911, 1.0265918, 1.0735312, 1.5195608, -0.20186861, -1.1942239, -0.123828925, 0.15206878, -0.5984882, 1.7251433, -1.1225498, 0.5972577, 0.4830021, 0.3292508, 0.2408948, 0.6181977, -1.6083776, -0.7942329, -2.9250402, -0.011456195, 1.5856475, 0.36158004, 1.1099474, 0.022764578, -0.6911674, 0.12137025, -0.054096308, 2.0104825, -10.552682, -0.3074241, -2.1401415, -1.5541011, 2.1952538, -0.24824409, -1.5486976, -1.9907504, -0.008541034, -0.37724724, -1.3050271, 0.61431825, -0.2921747, 1.1634012, 1.832196, -1.2632692, -0.86715615, 0.75093883, 0.0425117, 3.506064, -0.01778778, -0.00019779851, 0.7802857, -1.0070484, 0.8340708, 3.2723727, 1.9160148, -0.02847971, -0.446906, -0.49239567, -1.4269868, 1.4200358, 0.017069208, -1.0575687, 0.14418028, 0.640355, -1.3906267, 1.3350034, 0.72080314, -0.25404146, -0.31012732, 0.6170698, 1.6171819, -0.44203946, 0.18901323, -0.5639162, -1.9086038, 0.81321627, 0.6255031, 1.1891814, -0.28065336, 0.31110117, 0.5993803, -0.2425533, -1.4995453, 0.587675, 2.111423, 0.93153906, 1.420119, -0.5406842, 0.72722995, 0.3275199, 0.28424618, 0.77726483, -1.8104738, 1.3188448, 1.0816946, -0.7883469, -1.836056, -1.6683646, 1.4479759, -1.3368043, 0.038247824, -1.8241028, 0.83184576, 3.4053147, -0.038198475, -0.25721222, 1.4341226, -0.71697855, 0.034078185, 1.018841, -0.6654641, 0.4156678, -0.0011393024, 2.1488743, 0.71130127, 0.4621579, 0.62611514, 0.34392008, -1.1938525, -0.5432093, 0.0032544604, 1.7614115, -0.81705326, -0.3785425, -1.0343813, -0.44303054, -0.38170114, -0.73972106, -0.4715178, -1.5911533, 1.8154616, -1.8585852, -0.18346743, 2.0884774, -2.3090606, 0.26707894, -2.6919775, 0.57926536, 0.859194, -5.3992286, 0.3914111, 0.5071923, 0.25679228, 0.10145521, -1.1537873, -1.9789041, -0.29678598, 0.19423096, 0.5818787, -1.3614234, -1.6934961, 0.08367433, -0.64382154, 1.1154143, -0.55009174, 0.879377, 1.0284716, 0.2276318, 0.16358683, -6.637322, -0.2973011, 0.29127148, 0.24823704, -1.1619484, -0.09022997, -2.5227754, -1.0696012, -3.2464159, -0.6174363, -2.6580546, 0.8637286, -1.9644743, -2.4055355, -2.6646183, -0.020208828, -1.8115697, 0.13915238, -1.8562288, 0.14030242, -0.36561096, -1.2370956, -0.4277996, 0.8398204, 1.415266, 1.7070827, -1.6966027, 0.5889057, 2.2189925, 1.2044214, 6.6643643, 5.092001, -0.1313148, -3.6563153, -1.2136321, -2.3274808, 1.3136547, 0.24578798, -2.034344, 0.14458288, -1.0157928, 7.881099, 1.0835634, -0.73619324, -0.2717351, 1.5906106, 1.8904785, 2.4609094, 0.1585935, 4.230915, 6.6495905, 2.8846529, 0.06236169, -0.3373497, -3.1949708, 4.38536, -1.7243197, 1.419061, 1.1110952, -3.239857, 2.0398817, 0.24734944, -1.9565701, -2.4671783, 1.3825316, 1.7763946, -0.13832223, 0.39877057, -2.2225528, -0.19248515, 1.682126, 1.0992341, -0.036893435, -2.1738808, -0.5006096, -4.9557285, 0.5675076, -9.997941, 0.926342, -4.496138, -0.45475304, 0.9605521, -0.46495497, -0.05466513, -0.87791127, -1.4144001, 2.7251258, 0.7413443, 2.0112786, -2.3235412, 1.0057908, -0.569006, 0.17419821, 0.3651833, -1.206794, 2.0018048, 1.3397487, -0.2657639, 0.6897183, 2.1969664, -0.6317026, -0.170095, 2.221154, -0.9474597, -0.7836863, -0.8654947, -1.956734, 1.0937284, -2.476755, -1.6946694, -0.15094702, -0.1841323, -0.0087753525, -0.9939712, -0.5281789, -2.096636, 0.9614461, 1.140183, 0.12328826, 0.2880279, -0.89774173, 0.20323813, -0.615471, -0.20094708, 1.416309, -0.6630149, -0.2956904, 0.254693, -0.030750653, 1.1572508, -0.23357931, -0.3225508, 0.045026757, -0.058778636, -0.05896298, -0.6011147, -0.34724385, 1.0654153, -0.024627587, 1.4490396, -0.25526363, 0.5668908, -0.27573445, -9.452849, -1.6238213, -0.20353553, 0.19086139, 0.66175014, -0.13151458, 0.36854187, 0.6303071, 1.2871114, -1.3284314, -1.079848, -0.23568898, 0.0943585, 0.31370306, 0.63007486, 0.376623, -0.99005115, -0.8934582, -0.5803576, 2.874176, 0.5977048, -0.17047592, 0.0041744616, 1.9097242, 0.055445235, 0.014028109, -0.022316914, 0.3520213, -0.049675878, -0.6702818, 0.18570383, 0.68795156, -0.264006, -0.10451639, 1.2559953, -0.52700406, 1.0131928, -0.026389735, 0.3533608, -1.7262897, 0.053635687, 1.444439, 2.2202442, -0.25952548, -0.17712255, -0.0081532, 0.012188911, -0.24711943, -0.2296834, 0.14966536, 0.024078488, 0.09281939, -0.10306662, 0.1929847, -0.01864934, -0.115446985, -0.17209679, -0.12906897, -0.096016884, -0.18895775, -0.22633207, 0.23617387, 0.23640901, -0.1273042, 0.09169185, 0.02745676, -0.18969351, -0.14030796, -0.08673692, -0.22444433, 0.03608483, 0.060664654, 0.06551933, 0.18813258, 0.08258581, 0.07514638, 0.0011069775, 1.9733903, 1.8183769, -6.5732465, 0.30504715, -0.84018797, -0.94200814, 1.2031128, -1.297138, 1.0447952, -0.20104887, -0.8178782, 0.6206712, -0.5149347, -1.6069661, -1.4459668, 1.6353308, -0.47349447, 0.18236534, -0.95958114, -0.9136378, 5.274182, -0.3088687, -2.2355623, -0.215422, 2.803381, 0.73295176, -1.7050949, 2.7929842, -0.17447044, -3.1869278, -2.512616, -1.4990405, 1.4574413, -2.7930818, -0.047437802, 1.8982276, 1.2902182, 3.3623836, 0.19202144, 1.1505578, 3.1716793, -0.28348997, -2.4116914, 2.0045266, 4.1855087, 1.5701919, -2.370289, 0.009098725, 2.0656567, 1.2002435, 2.405295, -2.207202, -0.20107248, -0.84810865, -0.78044534, -1.5786736, 0.7826871, 0.372072, -0.49053174, 3.4375677, 3.108532, 0.009125988, 1.2989354, 2.8141687, -1.297358, -0.31439102, -0.65160125, -0.09786158, 0.13729624, -0.44119632, -0.0802278, -0.08532445, -0.2437358, -0.29170257, -0.4437365, -0.15301849, -1.3963058, 0.38125265, -0.35486975, 1.0270317, -0.1507524, 0.62496805, 0.7594784, -1.4696022, 1.0032228, -0.13414642, 0.34579813, -0.14782009, 0.7862199, -0.41606823, 1.6008767, -0.53601825, 0.80338544, 0.030854113, 0.07544777, -0.2759969, -0.5665272, 1.2450705, -0.6507682, -2.8200192, 1.0556325, 3.351977, 0.26199296, 0.1290663, 0.06853144, 0.17023285, 1.4025977, -0.44798863, -0.2343429, 0.3780948, -2.9092073, 2.1350613, 0.6203786, -1.6025308, 4.1608696, -3.8460028, -0.9139033, 0.9314829, 1.7378584, -0.142007, 0.961972, 0.19685043, 0.58304393, 0.6334213, 1.4708947, -0.24601845, 0.19582279, 0.18416691, -0.72875094, 0.32080442, 0.46651524, -0.2838829, 0.549476, -0.84944046, -0.98783004, -0.6223968, 0.7502104, -0.055097412, -0.23268197, 0.80045503, -1.9130005, 1.7060472, 0.6467862, 0.1223864, 0.8723844, 0.98992443, 1.3071527, -0.85073376, -1.3331399, 0.2859932, -0.58749956, 0.31195235, 1.4183145, 0.026393924, 0.09817711, 0.9764956, -0.72930926, -0.6484583, 0.26906973, 1.7514333, -0.13914254, 2.152965, 0.24136175, 2.9078622, -0.2516756, -0.9671432, -1.1853894, 0.27777705, -1.1045842, 0.03986737, 1.7486748, -0.14682539, -2.6611674, -1.030549, 2.4695315, -4.651007, -0.03481314, 1.5778681, -1.477428, -0.46214142, 0.16789167, -1.5150931, 0.6408108, 0.6503679, -2.3142636, -3.1325176, -0.6533839, -1.8545837, -1.3075624, -2.6252, -1.4172947, 0.59881234, -0.032196593, 0.7782372, 0.3035128, -0.16322142, -0.5069069, 0.39541015, 0.81055915, -1.819072, 0.7956028, 0.1484306, -0.21655242, 0.12059183, -5.6444807, 0.47462034, 1.2905167, 0.9275142, 0.6530295, 0.20213151, -0.07694083, -0.35376415, -0.23364338, 0.19529831, 0.29376334, 1.0175911, 0.8611976, -0.43847716, 0.76592886, 0.8025305, -0.14434022, 0.7419321, -1.5962933, -1.3539675, 0.6668089, -0.99023193, 0.25554085, -0.009028731, 1.0901277, 1.9099526, 0.06160011, -0.11914681, -3.266412, -0.2055183, 1.0780199, -1.1797795, 1.2677786, 3.0692675, 0.4753335, -2.083937, 2.2383244, -0.52191603, -0.00558119, 0.91065353, 1.342362, 0.9699837, 0.05350825, 0.28390586, -0.46773198, 0.21565677, -0.1936122, -0.6935181, 0.75527185, -1.421252, -0.16562939, -2.1339245, -2.313257, 0.029903341, 1.7895627, 0.50461346, -2.4919064, -0.15420938, 0.043956965, -0.9031648, -2.982103, -0.24220645, 2.3030515, 1.2529716, -4.584063, 0.028140562, 1.7116646, 1.3676785, -7.9860177, -0.27638716, 0.067164116, 0.93458027, 2.0015438, -1.035887, -0.18632407, -1.2000337, 0.30137083, -0.572202, 2.4458208, 1.6575949, -2.7018738, -0.28500038, 2.1391342, 0.08753816, -1.0459863, 0.8997343, 0.33771104, 0.29784223, 1.784341, 0.4235189, -0.84733385, -1.0878751, 1.6404128, 0.041972075, -0.16784157, 1.4920185, -3.0273883, 1.1494374, -3.1779187, 0.33898255, -1.2490008, -1.0035921, 0.72443444, 0.42658865, 0.18254906, 2.3242557, -0.69784504, -0.47939315, -0.032844916, 1.102297, -0.80762225, -0.70297533, 0.8200485, 0.71960443, 1.0104438, -0.045147028, -3.9319608, 1.6158824, 2.056683, 1.5468922, -0.1635178, 0.018950492, -0.59115773, -0.9760978, -0.60681057, -0.15984945, 1.1950358, -0.42089117, 1.3097044, 1.7072698, 0.7780595, 0.45508, -0.30482334, 0.22251934, 1.24388, 0.17852837, -10.868434, -0.39208564, -1.8998414, -2.4721563, 1.3643446, -0.3382038, -0.8742926, -0.16684894, -0.0048851348, 0.11965296, 0.8723195, -1.1545553, -0.4313834, -1.75606, -1.2309817, -0.12169093, 0.5950398, -0.5390967, -1.0454516, 0.39170977, -0.5034963, -0.29043946, 0.0046786484, 0.6706501, -0.5949613, -0.7553148, 1.1669705, 1.0635487, -0.6580506, 0.13258807, -3.0827818, -0.18922776, -3.7214286, -0.48777646, 0.8348286, 0.030487675, -1.5344977, -0.78344, -3.3801317, -0.9329918, 0.589619, -0.90318316, -0.23700388, 0.36181238, 0.48590294, -1.2125764, -1.8632567, 0.21012102, 0.95195305, -0.427278, -0.07847127, -0.6853291, -0.7265323, -0.007653244, 0.26850855, 1.524409, 0.29516065, 0.54120886, 0.2847206, 1.5913787, 0.41427535, 0.124490805, -0.33151397, 0.7502252, 1.2816485, -0.8543986, 0.056148533, -0.28219718, -0.08243232, -0.50785536, -4.260815, -0.53115356, 0.43462223, -1.1314055, 0.6532401, 0.19809476, 0.12289251, 0.29722828, 1.1254599, 1.9043301, -1.4026195, -0.18343596, -2.0444264, -0.29544207, 0.38008627, -0.1443758, 0.19928023, 1.7972668, -8.429418, 2.4628744, -0.11024071, 0.9977954, 0.7912476, 0.12384335, -1.1507173, 0.34509072, 1.2050544, 0.55225146, -3.338935, -1.4179564, 1.958646, -1.1910703, 1.9442222, 0.8015839, -1.8480501, 0.10539576, 1.4954902, 1.2143781, -1.4657029, -8.661429, -1.5763181, 0.8378264, 1.2839485, 1.301179, -1.8504157, 0.77602875, 1.2731335, -0.019607361, 0.5386834, 0.8774085, 0.64605105, -0.090435125, -0.22130686, -0.4641592, 2.776774, -1.5183476, 0.54666495, 1.1712165, -0.14749964, 3.24415, -0.37911636, 1.3999368, 0.83730084, 1.325871, 1.445552, -1.7466861, -0.044216745, 0.39519674, 1.0958622, -0.4661455, -0.02067115, 0.18262833, -0.7239902, 1.0536839, -0.50973946, 1.3349425, 1.5311321, 1.0791402, 0.20042308, 0.100533694, 0.877575, -2.2885404, 1.5501497, 1.4016879, 0.62248063, -0.14800096, 0.2121282, 0.19587192, 0.5591, 0.17112114, -0.36453006, 0.0147222355, -0.5857401, -2.0914407, -1.1861936, -0.23053817, -0.32374793, 0.38738388, -0.8891145, -0.07195643, -0.8413549, -1.0562276, 0.2752213, -2.7945852, 1.4033961, -0.07133388, 0.8784362, 0.031794995, -1.9122229, 0.30809703, 4.1693897, -0.02025982, 0.44808584, -1.5555036, 0.7833874, 0.33408144, 1.4055233, -0.21105982, -0.04294683, 0.037592016, 1.3246639, 0.035211157, -0.38989267, 1.6364655, 1.435024, 1.1754518, 0.4263705, 1.6701142, 1.2992028, -0.45944068, -0.25359058, -0.25483754, -0.72750634, -1.3557011, 0.328543, -0.4893178, -3.0518632, -0.7712231, -1.7794071, -0.44694078, 0.7094135, -0.38971752, 0.8549793, 0.06264755, 0.52740437, -0.6427605, -0.145914, -1.6109649, -0.8700057, 0.22324412, 0.13072799, 1.5030768, -1.4521246, 0.9600911, 4.2469473, -0.7175208, 1.6204767, -2.482521, 0.047915414, -1.3699561, -1.0223309, -1.1183422, 0.06858483, 0.816527, 1.7776778, 0.22465317, -0.778694, 0.8591446, 1.0024348, -0.321695, 0.92446554, -2.4637654, 0.24301276, 2.0256402, -0.030806884, 0.017756756, 0.77318716, -1.9207506, -2.1010137, 0.27816653, 1.1512619, -2.4198256, -1.0032228, 3.9081142, -0.12420077, -0.45618793, -0.82138205, -0.921327, -3.1324694, 1.9012494, -2.336075, -0.005299254, 2.7520456, -2.8850706, 2.0799878, -2.2325687, -1.9612095, -4.0339966 };
    float bias_layer1[32] = { 0.7582742, -0.75507325, -3.0111456, -0.50275487, 0.8753629, -1.0746636, 2.446988, 2.1706033, 1.7194109, -0.1036632, -0.513089, 2.0179837, -1.148116, 1.5349754, -0.34667936, -1.0259942, 0.7609215, 0.72146076, 2.34583, -0.761258, -0.54431313, 2.6170168, 0.35449165, -0.57719433, 1.3458756, 2.434099, 0.07043053, 1.0993514, 0.18156047, 0.3255853, -0.40558243, 1.249681 };

    float weights_2[384] = { -1.0776756, -1.3147844, 0.20737423, -0.6765495, 0.49053347, 1.0717168, 1.6044797, -1.4774531, 0.8013412, 1.0558257, 0.50405794, 1.7366188, 0.6667017, 0.63770777, 0.35586518, -0.49509862, 0.6368096, 0.29916003, -0.030559056, -1.8914827, -1.3089849, -0.7942645, 1.12427, -1.6186084, 1.1960027, -1.9252168, 0.7356928, 0.07868941, -3.0551047, 0.029778305, 0.3417553, 0.005750029, -4.8640285, 0.68149954, -0.45349187, 1.3677524, -0.3979651, -0.30502632, -1.2487855, -0.61232036, -1.1979648, 0.06265191, 0.35702515, -1.8223356, 0.7891632, 0.26505753, -0.45611957, 1.023975, 1.5132861, 0.67007995, 1.0987282, 0.9763376, -1.7418936, -0.9592612, 0.5348771, -0.29321864, -1.237796, 0.56017137, 0.12171247, 1.3679653, 1.6715803, -5.529658, 1.573323, 1.1935587, -0.70550156, 0.9556995, 0.0886714, 1.4614211, 0.9021091, 1.2388625, -1.6436895, -0.43275303, -2.0647273, -0.4515945, -2.6461434, 0.009170141, -0.3745809, -0.8790843, 0.13942534, -0.10362274, 0.44249007, -0.06749029, 0.69594806, -1.1370302, -0.079898424, 0.23696873, 0.27984342, 0.6443882, 0.9549398, 1.8730694, -0.7063265, -0.32852226, 0.81112254, -0.32777274, 0.26731193, 0.16233832, -1.3190492, -1.1334665, -0.20730242, 0.5360037, 2.1590042, 1.7916571, -0.43831626, 0.3368008, 1.1578269, -0.7382734, -2.042272, 0.46406275, 0.3518113, -0.30470425, -0.3252207, -0.31419528, -0.27306825, 0.2828298, -0.00030250702, 0.17707679, 0.29927263, 0.0047163116, 0.25866958, -0.27894232, -3.3661218, -0.57097006, -1.4835166, 0.34186482, 0.17351997, -0.6928115, 0.14723822, 0.10658136, -6.3217025, 0.9072057, 0.5680703, 0.5754624, -0.029671285, 0.308476, -1.8973025, -2.2284205, 0.32269797, 0.0047454624, 0.40746635, -0.92812717, 1.1224742, 0.9306235, 0.08886945, -0.95239574, 0.5922793, -1.192105, 4.880255, -0.09781882, 0.08037819, 0.49474388, -0.29574925, 1.3757944, -8.938625, 1.671616, -0.8210724, -2.6335163, -0.85872304, 0.05710449, -0.25652707, 1.3182288, 1.448402, 0.24245346, -0.2757149, 0.023206104, -0.5531231, -0.7686813, 1.4224439, -0.10994312, 0.1227722, 1.378161, 1.1312406, 0.6982871, -0.5291593, 1.4697375, -0.1705542, -0.40141442, -0.5823784, -1.2778978, 2.2525904, 1.0261854, -0.9503368, 1.1987795, -0.19007505, 0.7959017, -0.17495693, -0.33236474, -0.9224404, 1.6852432, -1.826458, -2.250439, 1.6303039, -2.68815, 3.4514549, 0.72387505, 0.44943804, 1.8188201, -1.9967368, -1.2593406, -0.7436671, 0.43258572, -6.781035, -2.210034, -0.32614863, 0.68169093, 0.4179712, -0.056608494, -0.5558854, 0.19468868, 0.69128186, -0.21905646, 0.02514923, 1.6966395, -1.554362, 1.6855055, 0.8714407, -0.8611408, 0.44222623, -0.19939849, -0.5195034, -0.5745365, -1.9702122, -0.29416254, -0.31498152, -4.7438993, -0.74634695, -1.668652, 0.003360679, 0.5596956, 7.01443, -0.40622377, 2.007822, -0.5268814, 0.8504368, -0.71703976, 1.2891443, -4.9333982, -6.571599, -4.107598, -3.261086, 6.465988, 1.8071932, -5.6566525, -1.8768044, 3.140386, 0.37932423, -0.5795927, 2.077093, 3.826655, -5.400461, -3.407628, -3.5716436, 2.4741452, -3.7452927, -0.08003323, 0.15410045, 1.326483, 0.48212436, 1.0596213, 1.8415985, -0.56234264, 1.3801314, -0.613715, -0.19726728, 0.7631878, 0.14879552, 1.6270226, 1.9360361, 1.9889982, -3.5835629, 0.35402438, 0.13123761, -0.3758243, 1.1887579, 0.8859621, 0.17302123, 0.9182421, 0.16702512, -0.27097467, -0.27197292, 0.94343823, -1.4961638, 1.5976516, -0.118680574, -0.13360286, -0.45957524, 1.4577919, 0.0553169, -0.9222579, 0.027334685, 0.15163554, -0.20688246, -1.4979004, 0.9803677, 1.4031714, -0.07312521, 1.3061959, -1.0913228, 0.3305174, -0.08048928, 0.6749976, -0.20779544, -0.11277136, -0.2978459, 0.57893246, -1.6328716, 0.6781056, 0.44731098, -2.12867, -0.22701299, -0.94540054, 0.8309143, -0.22553113, -0.38468587, -2.4200606, 1.1629174, -0.06345689, 0.3361409, -1.311319, 0.19196132, 1.1387951, -0.34856611, -2.1115727, -0.7988417, 0.30617917, 0.26113814, 0.43487194, -1.1414896, 0.3599514, 0.8588388, -0.6900519, -0.072236866, -0.59592086, 1.6001174, 0.9715193, 0.0889608, 0.8945874, -2.2072184, 1.6205336, 0.53789717, -0.85038763, -0.4101882, -0.7340553, 0.19234379, 1.0570667, 0.5566149, 0.33778074, -0.6696115, -2.221348, -2.764817, 0.6963998, -0.7466742, 0.31612268, 1.0112323, -0.574161, 0.074306555, 0.7724715, 0.89298177, 0.6011257, 0.50632286, 1.1769851, 1.5346974, -0.29800856, -0.3238323, -1.3794582, 1.3399005, 1.185522, -0.4744056, 3.0512996, 0.1523675, 1.1203022, 0.51360863, -0.008268268, -1.8573719, 0.7172529, -2.6777313, 0.043847747, 0.12750416, 0.21563663, 1.534379, -0.8510342, -1.040005, 0.12610841, -1.3645543, 0.38518262 };
    float bias_layer2[12] = { -3.0903578, 0.6339298, -2.9059613, 0.6387536, -1.1743927, -0.27512303, 0.8023947, -1.7208928, 1.0930505, -0.9298643, 1.5198933, -1.5047983 };

    float weights_3[48] = { -0.12414791, -0.90567005, -0.37591064, -1.906433, -0.8674501, 0.008725387, -0.38475412, -0.33235, 0.41237846, -0.90887004, 0.33842444, 0.23409782, -1.1726223, -0.034300853, -0.64829206, -0.42697167, -1.4713745, -1.291994, -1.253089, -0.78158563, -0.096561946, -0.7684708, 0.108229235, -0.19535324, 0.3506141, 0.42908615, -1.7495492, 0.37021083, -0.46873206, -1.1535674, 0.025578123, -0.480728, -0.31499103, 0.5361666, 0.50303316, -0.16799787, 0.9374727, -0.42386782, 0.8051374, -0.007503911, -0.4415335, 0.16502431, -0.44653633, 0.268777, 0.0774917, 0.15245734, 0.3340022, -0.45808613 };
    float bias_layer3[4] = { 0.3532722, -0.3828655, -4.406607, 0.92178893 };
};


int main(int argc, char* argv[]) {
    rclcpp::init(argc, argv);
    auto node = std::make_shared<ImageInferenceNode>();
    rclcpp::spin(node);
    rclcpp::shutdown();
    return 0;
}